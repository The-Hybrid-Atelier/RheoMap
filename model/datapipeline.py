import libraries.config as config
from libraries.haws import *
import libraries.rheosense as rheosense

DATA_DIRECTORY = "models"
msg = config.test1
data = msg["data"]
name = msg["params"]["material"]
mid = msg["time"]

msg = {'sender': 'rheosense-controller', 'event': 'matread', 'time': [12123], 'data': [497, 497, 497, 497, 497, 497, 496, 497, 497, 497, 497, 497, 497, 497, 477, 454, 428, 405, 386, 365, 348, 335, 324, 310, 298, 290, 284, 296, 422, 486, 542, 591, 645, 691, 720, 753, 791, 813, 823, 829, 583, 498, 498, 498, 497, 498, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 496, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 496, 497, 497, 497, 497, 497, 440, 418, 399, 377, 360, 345, 330, 317, 309, 299, 287, 278, 272, 287, 415, 481, 540, 590, 640, 687, 712, 756, 785, 807, 822, 830, 596, 499, 498, 498, 498, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 496, 497, 496, 497, 496, 497, 496, 497, 497, 497, 497, 497, 497, 497, 497, 496, 497, 496, 440, 418, 399, 377, 360, 346, 331, 317, 309, 297, 288, 279, 272, 293, 418, 482, 540, 589, 642, 687, 713, 758, 786, 807, 822, 830, 592, 500, 498, 498, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 497, 496, 497, 496, 497, 497, 497, 497, 497, 496, 496, 497, 497, 497, 497], 'params': {'material': 'honeytest'}}
data = msg['data']

rheosense.load_models(DATA_DIRECTORY)

idx = 0
entry = rheosense.sense(data, name, idx)
idx+=1

print(entry)


# // TARGET MESSAGE
#    {
#     name: "xxx",
#     id: 1,
#     mean: [406.313122923588, 397.3405315614618, 380.8255813953488, 365.38621262458474, 352.0722591362126, 339.93936877076413, 328.8679401993355, 318.99169435215947, 309.9908637873754, 302.04651162790697, 295.10880398671094, 288.79651162790697, 310.5531561461794, 378.0074750830565, 449.4609634551495, 504.3696013289036, 554.343853820598, 599.7691029900333, 638.9709302325581, 673.6968438538206, 704.2259136212624, 728.4360465116279, 749.8139534883721, 768.6544850498339, 740.6270764119602, 642.3579734219269, 530.5066445182724, 503.10132890365446, 500.36710963455147, 499.5971760797342, 499.62126245847173], 
#     interval_lb: [380.41936367575124, 379.09116595231455, 359.3486268245178, 342.12712188812833, 327.444400711091, 313.80198695380875, 301.17474987758163, 289.68048519952765, 279.4448627296069, 270.3569776464244, 262.6264939868676, 256.04630111203113, 274.7465005983259, 330.8615337992069, 417.90849126305164, 477.41126374385345, 529.8795486696544, 576.4630099585248, 615.1488982345089, 644.8890899134241, 668.527798689547, 681.173344599347, 690.1975456358624, 697.8646318833513, 650.8778507103568, 515.3642748745, 497.1590562543266, 498.1948933923552, 495.74147005373555, 493.8448258602314, 493.964624495557], 
#     interval_ub: [432.2068821714248, 415.589897170609, 402.30253596617985, 388.64530336104116, 376.7001175613342, 366.0767505877195, 356.5611305210894, 348.3029035047913, 340.53686484514395, 333.7360456093895, 327.59111398655426, 321.54672214378286, 346.35981169403294, 425.15341636690613, 481.01343564724743, 531.3279389139539, 578.8081589715417, 623.0751960215417, 662.7929622306073, 702.5045977942171, 739.9240285529778, 775.6987484239087, 809.4303613408819, 839.4443382163164, 830.3763021135635, 769.3516719693539, 563.8542327822183, 508.0077644149537, 504.9927492153674, 505.34952629923697, 505.27790042138645],
#     pca: [
#       0.11736950283504394,
#       0.1550755364990677,
#       0.4011382432847494
#     ], 
#     lda:{
#       category: "honey",
#       confidence: 0.99
#     }
# 	}

